{"ast":null,"code":"import _asyncToGenerator from \"/home/meghna/mogi/kube-mogi/cheeta/frontend/cheeta/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Subject } from \"rxjs\";\nimport { environment } from \"src/environments/environment\";\nimport { NotificationsComponent } from \"../notifications/notifications.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"src/app/service/notification/notifications.service\";\nconst usersURL = environment.cheetaUserURL;\nexport class AuthService {\n  constructor(http, router, dialog, notification) {\n    this.http = http;\n    this.router = router;\n    this.dialog = dialog;\n    this.notification = notification;\n    this.token = null;\n    this.tokenTimer = null;\n    this.authStatusListener = new Subject();\n    this.authStatus = false;\n  }\n\n  getToken() {\n    return this.token;\n  }\n\n  getAuthStatusListener() {\n    return this.authStatusListener.asObservable();\n  }\n\n  getAuthStatus() {\n    return this.authStatus;\n  }\n\n  register(regData) {\n    console.log(\"api url\", usersURL);\n    this.http.post(usersURL, regData).subscribe(resp => {\n      console.log(\"lolz ::: new resopnse\", resp);\n      console.log(\"userId::\", resp.data.userId);\n\n      if (resp && resp.status && resp.status.code == 200) {\n        this.router.navigate(['/auth/verifyOTP'], {\n          queryParams: {\n            email: resp.data.email,\n            userId: resp.data.userId\n          }\n        });\n      }\n    }, error => {\n      console.log(error);\n    });\n  }\n\n  verifyOtp(otpData) {\n    console.log('verfying otp', otpData);\n    this.http.post(usersURL + \"/verifyOTP\", otpData).subscribe(resp => {\n      console.log(\"lolz ::: new resopnse\", resp);\n      if (resp && resp.status && resp.status.code == 200) this.router.navigate(['/auth/login']);\n    }, error => {\n      console.log(error);\n    });\n  }\n\n  autoAuthUser() {\n    const authInfo = this.getAuthData();\n\n    if (authInfo) {\n      let expiresIn = new Date(authInfo.expirationDate).getTime() - new Date().getTime();\n\n      if (expiresIn > 0) {\n        this.token = authInfo.token;\n        this.authStatus = true;\n        this.tokenTimer = setTimeout(() => {\n          this.logout();\n        }, expiresIn);\n        this.authStatusListener.next(true);\n      }\n    }\n  }\n\n  login(form) {\n    var _this = this;\n\n    console.log(\"api url :: \", usersURL);\n    this.http.post(usersURL + 'login', form).subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (resp) {\n        if (resp) {\n          console.log('login res ::', resp);\n          _this.token = resp.data.token;\n\n          if (_this.token != null) {\n            let expirationDate = _this.getExpirationDate(resp.data.expiresIn);\n\n            _this.saveAuthData(resp.data, expirationDate);\n\n            _this.tokenTimer = setTimeout(() => {\n              _this.logout();\n            }, resp.data.expiresIn * 1000);\n\n            _this.authStatusListener.next(true);\n\n            _this.authStatus = true;\n\n            _this.router.navigate(['']);\n          }\n        }\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), err => {\n      console.log(err); // console.log(\"geetaaa\", err);\n      // this.authStatusListener.next(false);\n    });\n  }\n\n  logout() {\n    this.token = null;\n    this.authStatus = false;\n    this.authStatusListener.next(false);\n    clearTimeout(this.tokenTimer);\n    localStorage.clear();\n    this.notification.openDialog(' Logout Successful');\n    this.router.navigate(['/auth/login']);\n  }\n\n  saveAuthData(obj, expirationDate) {\n    localStorage.setItem('expirationDate', expirationDate.toISOString());\n    localStorage.setItem('mobile', obj.mobile);\n    localStorage.setItem('token', obj.token);\n    localStorage.setItem('email', obj.email);\n    localStorage.setItem('userId', obj.userId);\n  }\n\n  getAuthData() {\n    if (localStorage.getItem(\"token\") && localStorage.getItem(\"expirationDate\")) return {\n      token: localStorage.getItem(\"token\"),\n      expirationDate: localStorage.getItem(\"expirationDate\")\n    };\n    return false;\n  }\n\n  getExpirationDate(expiresIn) {\n    let now = new Date();\n    return new Date(now.getTime() + expiresIn * 1000);\n  }\n\n  resendOtp(email) {\n    console.log(email);\n    return new Promise((resolve, reject) => {\n      try {\n        this.http.post(usersURL + '/forgetPassword', {\n          email\n        }).subscribe(resp => {\n          console.log(\"resp of send otp for pass forget\", resp);\n\n          if (resp && resp.status.code == 200) {\n            console.log('OTP sent');\n          }\n\n          resolve(resp);\n        }, error => {\n          console.log(error);\n        });\n      } catch (err) {\n        console.log(\"inside catch err\", err);\n        reject(err);\n      }\n    });\n  }\n\n  changePassword(data) {\n    console.log(\"data\", data);\n    return new Promise((resolve, reject) => {\n      try {\n        this.http.post(usersURL + '/newPassword', data).subscribe(resp => {\n          console.log(resp);\n          console.log(resp.status);\n\n          if (resp && resp['status'] && resp['status'].code == 200) {\n            this.openDialog(' Your Password has been Updated');\n            this.router.navigate(['/auth/login']);\n          }\n        }, error => {\n          console.log(error);\n        });\n      } catch (err) {\n        console.log(\"inside catch err of resetPass\", err);\n        reject(err);\n      }\n    });\n  }\n\n  openDialog(warning) {\n    const dialogRef = this.dialog.open(NotificationsComponent, {\n      data: warning\n    });\n  }\n\n}\n\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.MatDialog), i0.ɵɵinject(i4.NotificationsService));\n};\n\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/meghna/mogi/kube-mogi/cheeta/frontend/cheeta/src/app/pages/auth/auth.service.ts"],"names":["Subject","environment","NotificationsComponent","i0","i1","i2","i3","i4","usersURL","cheetaUserURL","AuthService","constructor","http","router","dialog","notification","token","tokenTimer","authStatusListener","authStatus","getToken","getAuthStatusListener","asObservable","getAuthStatus","register","regData","console","log","post","subscribe","resp","data","userId","status","code","navigate","queryParams","email","error","verifyOtp","otpData","autoAuthUser","authInfo","getAuthData","expiresIn","Date","expirationDate","getTime","setTimeout","logout","next","login","form","getExpirationDate","saveAuthData","err","clearTimeout","localStorage","clear","openDialog","obj","setItem","toISOString","mobile","getItem","now","resendOtp","Promise","resolve","reject","changePassword","warning","dialogRef","open","ɵfac","AuthService_Factory","t","ɵɵinject","HttpClient","Router","MatDialog","NotificationsService","ɵprov","ɵɵdefineInjectable","factory","providedIn"],"mappings":"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","sourcesContent":["import { Subject } from \"rxjs\";\nimport { environment } from \"src/environments/environment\";\nimport { NotificationsComponent } from \"../notifications/notifications.component\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"src/app/service/notification/notifications.service\";\nconst usersURL = environment.cheetaUserURL;\nexport class AuthService {\n    constructor(http, router, dialog, notification) {\n        this.http = http;\n        this.router = router;\n        this.dialog = dialog;\n        this.notification = notification;\n        this.token = null;\n        this.tokenTimer = null;\n        this.authStatusListener = new Subject();\n        this.authStatus = false;\n    }\n    getToken() {\n        return this.token;\n    }\n    getAuthStatusListener() {\n        return this.authStatusListener.asObservable();\n    }\n    getAuthStatus() {\n        return this.authStatus;\n    }\n    register(regData) {\n        console.log(\"api url\", usersURL);\n        this.http\n            .post(usersURL, regData)\n            .subscribe((resp) => {\n            console.log(\"lolz ::: new resopnse\", resp);\n            console.log(\"userId::\", resp.data.userId);\n            if (resp && resp.status && resp.status.code == 200) {\n                this.router.navigate(['/auth/verifyOTP'], { queryParams: { email: resp.data.email, userId: resp.data.userId } });\n            }\n        }, error => {\n            console.log(error);\n        });\n    }\n    verifyOtp(otpData) {\n        console.log('verfying otp', otpData);\n        this.http\n            .post(usersURL + \"/verifyOTP\", otpData)\n            .subscribe((resp) => {\n            console.log(\"lolz ::: new resopnse\", resp);\n            if (resp && resp.status && resp.status.code == 200)\n                this.router.navigate(['/auth/login']);\n        }, error => {\n            console.log(error);\n        });\n    }\n    autoAuthUser() {\n        const authInfo = this.getAuthData();\n        if (authInfo) {\n            let expiresIn = new Date(authInfo.expirationDate).getTime() - (new Date()).getTime();\n            if (expiresIn > 0) {\n                this.token = authInfo.token;\n                this.authStatus = true;\n                this.tokenTimer = setTimeout(() => {\n                    this.logout();\n                }, expiresIn);\n                this.authStatusListener.next(true);\n            }\n        }\n    }\n    login(form) {\n        console.log(\"api url :: \", usersURL);\n        this.http\n            .post(usersURL + 'login', form)\n            .subscribe(async (resp) => {\n            if (resp) {\n                console.log('login res ::', resp);\n                this.token = resp.data.token;\n                if (this.token != null) {\n                    let expirationDate = this.getExpirationDate(resp.data.expiresIn);\n                    this.saveAuthData(resp.data, expirationDate);\n                    this.tokenTimer = setTimeout(() => {\n                        this.logout();\n                    }, resp.data.expiresIn * 1000);\n                    this.authStatusListener.next(true);\n                    this.authStatus = true;\n                    this.router.navigate(['']);\n                }\n            }\n        }, err => {\n            console.log(err);\n            // console.log(\"geetaaa\", err);\n            // this.authStatusListener.next(false);\n        });\n    }\n    logout() {\n        this.token = null;\n        this.authStatus = false;\n        this.authStatusListener.next(false);\n        clearTimeout(this.tokenTimer);\n        localStorage.clear();\n        this.notification.openDialog(' Logout Successful');\n        this.router.navigate(['/auth/login']);\n    }\n    saveAuthData(obj, expirationDate) {\n        localStorage.setItem('expirationDate', expirationDate.toISOString());\n        localStorage.setItem('mobile', obj.mobile);\n        localStorage.setItem('token', obj.token);\n        localStorage.setItem('email', obj.email);\n        localStorage.setItem('userId', obj.userId);\n    }\n    getAuthData() {\n        if (localStorage.getItem(\"token\") &&\n            localStorage.getItem(\"expirationDate\"))\n            return {\n                token: localStorage.getItem(\"token\"),\n                expirationDate: localStorage.getItem(\"expirationDate\")\n            };\n        return false;\n    }\n    getExpirationDate(expiresIn) {\n        let now = new Date();\n        return new Date(now.getTime() + expiresIn * 1000);\n    }\n    resendOtp(email) {\n        console.log(email);\n        return new Promise((resolve, reject) => {\n            try {\n                this.http\n                    .post(usersURL + '/forgetPassword', { email })\n                    .subscribe((resp) => {\n                    console.log(\"resp of send otp for pass forget\", resp);\n                    if (resp && resp.status.code == 200) {\n                        console.log('OTP sent');\n                    }\n                    resolve(resp);\n                }, error => {\n                    console.log(error);\n                });\n            }\n            catch (err) {\n                console.log(\"inside catch err\", err);\n                reject(err);\n            }\n        });\n    }\n    changePassword(data) {\n        console.log(\"data\", data);\n        return new Promise((resolve, reject) => {\n            try {\n                this.http\n                    .post(usersURL + '/newPassword', data)\n                    .subscribe((resp) => {\n                    console.log(resp);\n                    console.log(resp.status);\n                    if (resp && resp['status'] && resp['status'].code == 200) {\n                        this.openDialog(' Your Password has been Updated');\n                        this.router.navigate(['/auth/login']);\n                    }\n                }, error => {\n                    console.log(error);\n                });\n            }\n            catch (err) {\n                console.log(\"inside catch err of resetPass\", err);\n                reject(err);\n            }\n        });\n    }\n    openDialog(warning) {\n        const dialogRef = this.dialog.open(NotificationsComponent, {\n            data: warning,\n        });\n    }\n}\nAuthService.ɵfac = function AuthService_Factory(t) { return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.MatDialog), i0.ɵɵinject(i4.NotificationsService)); };\nAuthService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: AuthService, factory: AuthService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}